<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyVibe - Professional Weather Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dark: #1e293b;
            --light: #f8fafc;
            --card-bg: rgba(255, 255, 255, 0.95);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 30px 90px rgba(0, 0, 0, 0.15);
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
            overflow-x: hidden;
            transition: background 1s ease;
        }

        body.clear { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        body.clouds { background: linear-gradient(135deg, #616161 0%, #9bc5c3 100%); }
        body.rain { background: linear-gradient(135deg, #3a7bd5 0%, #3a6073 100%); }
        body.drizzle { background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%); }
        body.thunderstorm { background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); }
        body.snow { background: linear-gradient(135deg, #e6e9f0 0%, #eef1f5 100%); }
        body.mist { background: linear-gradient(135deg, #bdc3c7 0%, #2c3e50 100%); }
        body.fog { background: linear-gradient(135deg, #C9D6FF 0%, #E2E2E2 100%); }
        body.haze { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }

        .background-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(100vh) translateX(100px) rotate(360deg); opacity: 0; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 40px 20px 20px;
            color: white;
            animation: fadeInDown 0.8s ease;
        }

        .logo {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            letter-spacing: -1px;
            background: linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.8) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.95;
            font-weight: 300;
        }

        .version-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            backdrop-filter: blur(10px);
        }

        .greeting-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 30px;
            margin-bottom: 30px;
            color: white;
            animation: fadeIn 1s ease;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .greeting-left h2 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .greeting-left p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .greeting-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .moon-phase {
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            border-radius: 16px;
        }

        .moon-emoji {
            font-size: 3rem;
            margin-bottom: 5px;
        }

        .moon-text {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            animation: fadeIn 1s ease 0.2s both;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 16px 120px 16px 20px;
            border: none;
            border-radius: 16px;
            font-size: 1rem;
            background: white;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .search-box input:focus {
            outline: none;
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .search-box button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .search-box button:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .unit-toggle {
            display: flex;
            background: white;
            border-radius: 16px;
            padding: 6px;
            box-shadow: var(--shadow);
        }

        .unit-toggle button {
            padding: 10px 24px;
            border: none;
            border-radius: 12px;
            background: transparent;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .unit-toggle button.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .auto-location-btn {
            padding: 16px 30px;
            background: white;
            color: var(--primary);
            border: none;
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .auto-location-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .quick-actions {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 16px 24px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 30px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeInUp 0.6s ease both;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .weather-main {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .weather-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
        }

        .weather-left {
            flex: 1;
        }

        .temperature {
            font-size: 5.5rem;
            font-weight: 800;
            line-height: 1;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .weather-condition {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .location {
            font-size: 1.2rem;
            color: #64748b;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .weather-score {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: linear-gradient(135deg, var(--success), #34d399);
            color: white;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 600;
            margin-top: 10px;
        }

        .weather-right {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .weather-icon-large {
            font-size: 8rem;
            animation: bounce 2s infinite;
            filter: drop-shadow(0 4px 20px rgba(0, 0, 0, 0.1));
        }

        .weather-mood {
            background: rgba(102, 126, 234, 0.1);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            color: var(--primary);
            text-transform: capitalize;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .detail-item {
            background: rgba(102, 126, 234, 0.05);
            padding: 18px;
            border-radius: 16px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .detail-item:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.05);
        }

        .detail-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .detail-label {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--dark);
        }

        .detail-subtitle {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-top: 4px;
        }

        .forecast-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) transparent;
        }

        .forecast-container::-webkit-scrollbar {
            height: 8px;
        }

        .forecast-container::-webkit-scrollbar-track {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
        }

        .forecast-container::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        .forecast-day {
            min-width: 160px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .forecast-day:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            transform: translateY(-5px);
        }

        .forecast-date {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .forecast-day-name {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 10px;
        }

        .forecast-icon {
            font-size: 3rem;
            margin: 10px 0;
        }

        .forecast-temp {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .forecast-desc {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 10px;
        }

        .forecast-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .alert-box {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .alert-box h4 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.95; transform: scale(1.01); }
        }

        .info-box {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .info-box h4 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .activity-item {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            padding: 18px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
        }

        .activity-item:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            transform: translateX(8px);
            border-color: var(--primary);
        }

        .activity-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            flex-shrink: 0;
        }

        .activity-details {
            flex: 1;
        }

        .activity-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .activity-mood {
            font-size: 0.85rem;
            color: #64748b;
        }

        .playlist-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
        }

        .playlist-item {
            display: flex;
            gap: 15px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            padding: 15px;
            border-radius: 16px;
            transition: var(--transition);
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            border: 2px solid transparent;
        }

        .playlist-item:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            transform: scale(1.02);
            border-color: var(--primary);
        }

        .playlist-image {
            width: 90px;
            height: 90px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            flex-shrink: 0;
        }

        .playlist-info {
            flex: 1;
        }

        .playlist-name {
            font-weight: 700;
            font-size: 1.15rem;
            margin-bottom: 6px;
            color: var(--dark);
        }

        .playlist-desc {
            font-size: 0.9rem;
            color: #64748b;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .playlist-meta {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sound-player {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 25px;
            border-radius: 16px;
            text-align: center;
        }

        .sound-icon {
            font-size: 4rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .sound-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .sound-btn {
            width: 65px;
            height: 65px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.6rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .sound-btn:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .sound-btn:active {
            transform: scale(1.05);
        }

        .volume-control {
            margin-top: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .volume-slider {
            width: 200px;
            height: 6px;
            border-radius: 10px;
            background: rgba(102, 126, 234, 0.2);
            outline: none;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        .fun-fact {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            padding: 25px;
            border-radius: 16px;
            font-size: 1.1rem;
            line-height: 1.7;
            position: relative;
            overflow: hidden;
        }

        .fun-fact::before {
            content: 'üí°';
            position: absolute;
            font-size: 10rem;
            opacity: 0.1;
            right: -30px;
            top: -30px;
        }

        .fun-fact-text {
            position: relative;
            z-index: 1;
        }

        .explore-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }

        .city-card {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
            padding: 20px;
            border-radius: 16px;
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
            border: 2px solid transparent;
        }

        .city-card:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.15), rgba(118, 75, 162, 0.15));
            transform: translateY(-5px);
            border-color: var(--primary);
        }

        .city-name {
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .city-country {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 15px;
        }

        .city-temp {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
        }

        .city-weather {
            font-size: 2rem;
            margin: 10px 0;
        }

        .city-desc {
            font-size: 0.9rem;
            color: #64748b;
            margin-top: 8px;
        }

        .health-tips {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .health-tip {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 4px solid var(--success);
        }

        .health-tip-icon {
            width: 40px;
            height: 40px;
            background: var(--success);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .clothing-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .clothing-tag {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #64748b;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(102, 126, 234, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            color: #dc2626;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            border-left: 4px solid #dc2626;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .refresh-btn {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .refresh-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success { background: #d1fae5; color: #065f46; }
        .badge-warning { background: #fef3c7; color: #92400e; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-info { background: #dbeafe; color: #1e40af; }
        .badge-primary { background: #e0e7ff; color: #4338ca; }

        .air-quality-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
            padding: 20px;
            border-radius: 16px;
            margin-top: 20px;
        }

        .aqi-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .aqi-indicator {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.8rem;
            flex-shrink: 0;
        }

        .aqi-info {
            flex: 1;
        }

        .aqi-level {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .aqi-advice {
            color: #64748b;
            line-height: 1.5;
        }

        .aqi-components {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .aqi-component {
            background: white;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
        }

        .component-label {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 5px;
        }

        .component-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .best-time-card {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            padding: 20px;
            border-radius: 16px;
            margin-top: 20px;
            text-align: center;
        }

        .best-time-card h4 {
            color: #92400e;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .best-time-display {
            font-size: 2rem;
            font-weight: 700;
            color: #78350f;
            margin: 10px 0;
        }

        footer {
            text-align: center;
            padding: 50px 20px;
            color: white;
            margin-top: 40px;
        }

        footer .footer-logo {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        footer h3 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        footer p {
            opacity: 0.9;
            margin: 10px 0;
        }

        footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            margin: 0 15px;
        }

        footer a:hover {
            opacity: 0.8;
            transform: scale(1.1);
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 16px;
            margin: 20px 0;
            color: white;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2.5rem; }
            .temperature { font-size: 4rem; }
            .weather-icon-large { font-size: 5rem; }
            .weather-display { flex-direction: column; }
            .controls { flex-direction: column; }
            .greeting-card { flex-direction: column; }
            .grid { grid-template-columns: 1fr; }
        }

        .color-palette {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .color-swatch {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            border: 3px solid white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .color-swatch:hover {
            transform: scale(1.15);
        }

        .compare-section {
            margin-top: 20px;
        }

        .compare-input {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .compare-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 0.95rem;
        }

        .compare-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="background-animation" id="particles"></div>

    <div class="container">
        <div class="header">
            <div class="logo">üå§Ô∏è</div>
            <h1>SkyVibe</h1>
            <p>Your Professional Weather Experience</p>
            <span class="version-badge">v2.0 Pro Edition</span>
        </div>

        <div class="greeting-card" id="greeting">
            <div class="greeting-left">
                <h2>Loading...</h2>
                <p>Detecting your location...</p>
            </div>
            <div class="greeting-right">
                <div class="moon-phase" id="moonPhase">
                    <div class="moon-emoji">üåô</div>
                    <div class="moon-text">Loading...</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="search-box">
                <input type="text" id="cityInput" placeholder="Search city or location...">
                <button onclick="searchWeather()"><i class="fas fa-search"></i> Search</button>
            </div>
            <div class="unit-toggle">
                <button class="active" onclick="setUnit('metric')">¬∞C</button>
                <button onclick="setUnit('imperial')">¬∞F</button>
            </div>
            <button class="auto-location-btn" onclick="autoDetectLocation()">
                <i class="fas fa-location-crosshairs"></i>
                Auto Detect
            </button>
            <div class="quick-actions">
                <button class="action-btn" onclick="loadFunFact()">
                    <i class="fas fa-lightbulb"></i> New Fact
                </button>
                <button class="action-btn" onclick="exploreWeather()">
                    <i class="fas fa-globe"></i> Explore
                </button>
            </div>
        </div>

        <div id="errorContainer"></div>
        <div id="alertsContainer"></div>

        <div class="grid">
            <div class="card weather-main">
                <div id="currentWeather">
                    <div class="loading">
                        <div class="spinner"></div>
                        <p>Loading weather data...</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-calendar-days"></i></div>
                        7-Day Forecast
                    </div>
                </div>
                <div id="forecast">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-heart-pulse"></i></div>
                        Health & Safety
                    </div>
                </div>
                <div id="healthTips">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-shirt"></i></div>
                        What to Wear
                    </div>
                </div>
                <div id="clothingTips">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-lightbulb"></i></div>
                        Fun Fact
                    </div>
                    <button class="refresh-btn" onclick="loadFunFact()">
                        <i class="fas fa-rotate"></i>
                    </button>
                </div>
                <div id="funFact">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-running"></i></div>
                        Activity Suggestions
                    </div>
                </div>
                <div id="activities">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fab fa-spotify"></i></div>
                        Spotify Playlists
                    </div>
                </div>
                <div id="spotify">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-music"></i></div>
                        Ambient Sounds
                    </div>
                </div>
                <div id="sounds">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-palette"></i></div>
                        Color Palette
                    </div>
                </div>
                <div id="colorPalette">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-globe"></i></div>
                        Explore Weather
                    </div>
                    <button class="refresh-btn" onclick="exploreWeather()">
                        <i class="fas fa-rotate"></i>
                    </button>
                </div>
                <div id="explore">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <div class="card" style="grid-column: 1 / -1;">
                <div class="card-header">
                    <div class="card-title">
                        <div class="card-icon"><i class="fas fa-code-compare"></i></div>
                        Compare Cities
                    </div>
                </div>
                <div class="compare-section">
                    <div class="compare-input">
                        <input type="text" id="compareInput" placeholder="Enter cities separated by commas (e.g., London, Paris, Tokyo)">
                        <button class="compare-btn" onclick="compareCities()">
                            <i class="fas fa-balance-scale"></i> Compare
                        </button>
                    </div>
                    <div id="compareResults"></div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-logo">üå§Ô∏è</div>
            <h3>SkyVibe Pro</h3>
            <p>Your Complete Weather Companion</p>
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalCities">50+</div>
                    <div class="stat-label">Global Cities</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">24/7</div>
                    <div class="stat-label">Live Updates</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">15+</div>
                    <div class="stat-label">Features</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">100%</div>
                    <div class="stat-label">Accurate</div>
                </div>
            </div>
            <p style="margin-top: 20px; opacity: 0.8;">
                <a href="#"><i class="fab fa-github"></i> GitHub</a> |
                <a href="#"><i class="fas fa-code"></i> API Docs</a> |
                <a href="#"><i class="fas fa-heart"></i> Support</a>
            </p>
            <p style="margin-top: 15px; font-size: 0.9rem;">
                Weather Visualizer Pro &copy; 2024 | Powered by OpenWeather & Spotify
            </p>
        </footer>
    </div>

    <audio id="audioPlayer" loop></audio>

    <script>
        const API_BASE = 'https://weatherly-9p4i.onrender.com/api';
        let currentUnit = 'metric';
        let currentWeatherData = null;
        let audioPlayer = document.getElementById('audioPlayer');
        let isPlaying = false;

        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 25; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = Math.random() * 6 + 2 + 'px';
                particle.style.height = particle.style.width;
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = Math.random() * 10 + 10 + 's';
                container.appendChild(particle);
            }
        }

        function setUnit(unit) {
            currentUnit = unit;
            document.querySelectorAll('.unit-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            if (currentWeatherData) {
                loadWeather(currentWeatherData.location.coordinates.lat, currentWeatherData.location.coordinates.lon);
            }
        }

        function getWeatherIcon(condition) {
            const icons = {
                'Clear': '‚òÄÔ∏è',
                'Clouds': '‚òÅÔ∏è',
                'Rain': 'üåßÔ∏è',
                'Drizzle': 'üå¶Ô∏è',
                'Thunderstorm': '‚õàÔ∏è',
                'Snow': '‚ùÑÔ∏è',
                'Mist': 'üå´Ô∏è',
                'Fog': 'üå´Ô∏è',
                'Haze': 'üå´Ô∏è',
                'Smoke': 'üí®',
                'Dust': 'üå™Ô∏è',
                'Tornado': 'üå™Ô∏è'
            };
            return icons[condition] || 'üå§Ô∏è';
        }

        function getActivityIcon(activity) {
            const icons = {
                'Hiking': 'ü•æ', 'Picnic': 'üß∫', 'Beach': 'üèñÔ∏è', 'Photography': 'üì∏',
                'Cycling': 'üö¥', 'Running': 'üèÉ', 'Museum': 'üèõÔ∏è', 'Shopping': 'üõçÔ∏è',
                'Coffee': '‚òï', 'Reading': 'üìö', 'Movie': 'üé¨', 'Cooking': 'üë®‚Äçüç≥',
                'Art': 'üé®', 'Board games': 'üé≤', 'Snowman': '‚õÑ', 'Swimming': 'üèä',
                'Ice skating': '‚õ∏Ô∏è', 'Hot chocolate': '‚òï', 'Baking': 'üßÅ',
                'Meditation': 'üßò', 'Yoga': 'üßò', 'Indoor': 'üè†', 'Outdoor': 'üå≥'
            };
            for (let key in icons) {
                if (activity.toLowerCase().includes(key.toLowerCase())) {
                    return icons[key];
                }
            }
            return 'üéØ';
        }

        function changeBodyTheme(weather) {
            document.body.className = weather.toLowerCase();
        }

        async function autoDetectLocation() {
            try {
                const response = await fetch(`${API_BASE}/location/auto`);
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('greeting').innerHTML = `
                        <div class="greeting-left">
                            <h2>${data.greeting}! üëã</h2>
                            <p><i class="fas fa-location-dot"></i> ${data.location.city}, ${data.location.country}</p>
                        </div>
                        <div class="greeting-right">
                            <div class="moon-phase">
                                <div class="moon-emoji">${data.moon_phase.emoji}</div>
                                <div class="moon-text">${data.moon_phase.phase}</div>
                                <small style="opacity: 0.8;">${data.moon_phase.illumination}% illuminated</small>
                            </div>
                        </div>
                    `;
                    loadWeather(data.location.lat, data.location.lon);
                }
            } catch (error) {
                showError('Failed to detect location');
            }
        }

        async function searchWeather() {
            const city = document.getElementById('cityInput').value;
            if (!city) return;

            try {
                const response = await fetch(`${API_BASE}/weather/current?city=${encodeURIComponent(city)}&units=${currentUnit}`);
                const data = await response.json();
                
                if (data.success) {
                    displayCurrentWeather(data);
                    loadWeather(data.location.coordinates.lat, data.location.coordinates.lon);
                }
            } catch (error) {
                showError('City not found');
            }
        }

        async function loadWeather(lat, lon) {
            loadCurrentWeather(lat, lon);
            loadForecast(lat, lon);
            loadAlerts(lat, lon);
            loadFunFact();
            exploreWeather();
        }

        async function loadCurrentWeather(lat, lon) {
            try {
                const response = await fetch(`${API_BASE}/weather/current?lat=${lat}&lon=${lon}&units=${currentUnit}`);
                const data = await response.json();
                
                if (data.success) {
                    currentWeatherData = data;
                    displayCurrentWeather(data);
                    loadActivities(data.weather.main, data.temperature.current);
                    loadSpotify(data.weather.main);
                    loadSounds(data.weather.main);
                    displayHealthTips(data);
                    displayClothingTips(data);
                    displayColorPalette(data);
                    changeBodyTheme(data.weather.main);
                }
            } catch (error) {
                showError('Failed to load weather data');
            }
        }

        function displayCurrentWeather(data) {
            const aqi = data.details.air_quality;
            const uv = data.details.uv_index;
            
            let aqiClass = 'aqi-good';
            let aqiColor = '#00e400';
            if (aqi && aqi.aqi > 1) { aqiClass = 'aqi-fair'; aqiColor = '#ffff00'; }
            if (aqi && aqi.aqi > 2) { aqiClass = 'aqi-moderate'; aqiColor = '#ff7e00'; }
            if (aqi && aqi.aqi > 3) { aqiClass = 'aqi-poor'; aqiColor = '#ff0000'; }
            if (aqi && aqi.aqi > 4) { aqiClass = 'aqi-very-poor'; aqiColor = '#8f3f97'; }

            document.getElementById('currentWeather').innerHTML = `
                <div class="weather-display">
                    <div class="weather-left">
                        <div class="temperature">${Math.round(data.temperature.current)}${data.temperature.unit}</div>
                        <div class="weather-condition">${data.weather.description}</div>
                        <div class="location">
                            <i class="fas fa-location-dot"></i>
                            ${data.location.name}, ${data.location.country}
                        </div>
                        <div class="weather-score">
                            <i class="fas fa-star"></i>
                            Weather Score: ${data.weather_score}/100
                        </div>
                    </div>
                    <div class="weather-right">
                        <div class="weather-icon-large">${data.weather.emoji || getWeatherIcon(data.weather.main)}</div>
                        <div class="weather-mood">${data.weather.mood} mood</div>
                    </div>
                </div>
                <div class="weather-details">
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-temperature-half"></i></div>
                        <div class="detail-label">Feels Like</div>
                        <div class="detail-value">${Math.round(data.temperature.feels_like)}¬∞</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-droplet"></i></div>
                        <div class="detail-label">Humidity</div>
                        <div class="detail-value">${data.details.humidity}%</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-wind"></i></div>
                        <div class="detail-label">Wind</div>
                        <div class="detail-value">${data.details.wind.speed}</div>
                        <div class="detail-subtitle">${data.details.wind.unit}</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-eye"></i></div>
                        <div class="detail-label">Visibility</div>
                        <div class="detail-value">${data.details.visibility}</div>
                        <div class="detail-subtitle">km</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-gauge"></i></div>
                        <div class="detail-label">Pressure</div>
                        <div class="detail-value">${data.details.pressure}</div>
                        <div class="detail-subtitle">hPa</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-cloud"></i></div>
                        <div class="detail-label">Clouds</div>
                        <div class="detail-value">${data.details.clouds}%</div>
                    </div>
                    ${uv ? `
                    <div class="detail-item">
                        <div class="detail-icon"><i class="fas fa-sun"></i></div>
                        <div class="detail-label">UV Index</div>
                        <div class="detail-value">${uv.value}</div>
                        <div class="detail-subtitle">${uv.level}</div>
                    </div>
                    ` : ''}
                </div>
                ${aqi ? `
                <div class="air-quality-card">
                    <div class="aqi-display">
                        <div class="aqi-indicator ${aqiClass}" style="background: ${aqiColor}; color: white;">
                            ${aqi.aqi}
                            <div style="font-size: 0.5rem; margin-top: 5px;">AQI</div>
                        </div>
                        <div class="aqi-info">
                            <div class="aqi-level">Air Quality: ${aqi.level}</div>
                            <div class="aqi-advice">${aqi.advice}</div>
                        </div>
                    </div>
                    <div class="aqi-components">
                        <div class="aqi-component">
                            <div class="component-label">PM2.5</div>
                            <div class="component-value">${aqi.components.pm2_5}</div>
                        </div>
                        <div class="aqi-component">
                            <div class="component-label">PM10</div>
                            <div class="component-value">${aqi.components.pm10}</div>
                        </div>
                        <div class="aqi-component">
                            <div class="component-label">O‚ÇÉ</div>
                            <div class="component-value">${aqi.components.o3}</div>
                        </div>
                        <div class="aqi-component">
                            <div class="component-label">NO‚ÇÇ</div>
                            <div class="component-value">${aqi.components.no2}</div>
                        </div>
                    </div>
                </div>
                ` : ''}
            `;
        }

        async function loadForecast(lat, lon) {
            try {
                const response = await fetch(`${API_BASE}/weather/forecast?lat=${lat}&lon=${lon}&units=${currentUnit}&days=7`);
                const data = await response.json();
                
                if (data.success) {
                    const forecastHTML = data.daily.map(day => {
                        return `
                            <div class="forecast-day">
                                <div class="forecast-date">${day.date}</div>
                                <div class="forecast-day-name">${day.day_name}</div>
                                <div class="forecast-icon">${day.weather.emoji || getWeatherIcon(day.weather.main)}</div>
                                <div class="forecast-temp">${Math.round(day.temperature.max)}¬∞ / ${Math.round(day.temperature.min)}¬∞</div>
                                <div class="forecast-desc">${day.weather.description}</div>
                                <span class="forecast-badge badge-info">${day.precipitation_probability}% rain</span>
                            </div>
                        `;
                    }).join('');
                    
                    let bestTimeHTML = '';
                    if (data.best_time_today) {
                        bestTimeHTML = `
                            <div class="best-time-card">
                                <h4>‚≠ê Best Time Today</h4>
                                <div class="best-time-display">${data.best_time_today.time}</div>
                                <p>${data.best_time_today.temperature}¬∞ ¬∑ ${data.best_time_today.weather}</p>
                            </div>
                        `;
                    }
                    
                    document.getElementById('forecast').innerHTML = `
                        ${bestTimeHTML}
                        <div class="forecast-container">${forecastHTML}</div>
                    `;
                }
            } catch (error) {
                document.getElementById('forecast').innerHTML = '<p>Failed to load forecast</p>';
            }
        }

        async function loadAlerts(lat, lon) {
            try {
                const response = await fetch(`${API_BASE}/weather/alerts?lat=${lat}&lon=${lon}`);
                const data = await response.json();
                
                if (data.success && data.has_alerts) {
                    const alertsHTML = data.alerts.map(alert => `
                        <div class="alert-box">
                            <h4><i class="fas fa-triangle-exclamation"></i> ${alert.event}</h4>
                            <p>${alert.description}</p>
                            <small>Source: ${alert.sender}</small>
                        </div>
                    `).join('');
                    
                    document.getElementById('alertsContainer').innerHTML = alertsHTML;
                } else {
                    document.getElementById('alertsContainer').innerHTML = '';
                }
            } catch (error) {
                console.error('Failed to load alerts');
            }
        }

        async function loadFunFact() {
            try {
                const response = await fetch(`${API_BASE}/insights/fun-fact`);
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('funFact').innerHTML = `
                        <div class="fun-fact">
                            <div class="fun-fact-text">${data.fact}</div>
                        </div>
                        <p style="text-align: center; margin-top: 15px; color: #64748b;">
                            <small>Fact ${Math.floor(Math.random() * data.total_facts) + 1} of ${data.total_facts}</small>
                        </p>
                    `;
                }
            } catch (error) {
                document.getElementById('funFact').innerHTML = '<p>Failed to load fun fact</p>';
            }
        }

        async function loadActivities(weather, temp) {
            try {
                const response = await fetch(`${API_BASE}/insights/activities?weather=${weather}&temp=${temp}`);
                const data = await response.json();
                
                if (data.success) {
                    const activitiesHTML = data.suggested_activities.map(activity => `
                        <div class="activity-item">
                            <div class="activity-icon">${getActivityIcon(activity)}</div>
                            <div class="activity-details">
                                <div class="activity-name">${activity}</div>
                                <div class="activity-mood">Perfect for ${data.mood} mood ${data.emoji}</div>
                            </div>
                        </div>
                    `).join('');
                    
                    document.getElementById('activities').innerHTML = `
                        <div class="activity-list">${activitiesHTML}</div>
                    `;
                }
            } catch (error) {
                document.getElementById('activities').innerHTML = '<p>Failed to load activities</p>';
            }
        }

        async function loadSpotify(weather) {
            try {
                const response = await fetch(`${API_BASE}/entertainment/spotify?weather=${weather}&limit=6`);
                const data = await response.json();
                
                if (data.success && data.playlists && data.playlists.length > 0) {
                    const playlistsHTML = data.playlists.map(playlist => `
                        <a href="${playlist.url}" target="_blank" class="playlist-item">
                            <img src="${playlist.image || 'https://via.placeholder.com/90'}" alt="${playlist.name}" class="playlist-image">
                            <div class="playlist-info">
                                <div class="playlist-name">${playlist.name}</div>
                                <div class="playlist-desc">${playlist.description || 'Curated for ' + data.mood + ' mood'}</div>
                                <div class="playlist-meta">
                                    <span class="badge badge-success">${playlist.tracks} tracks</span>
                                    <span class="badge badge-primary">${data.category}</span>
                                </div>
                            </div>
                        </a>
                    `).join('');
                    
                    document.getElementById('spotify').innerHTML = `
                        <div class="info-box" style="margin-bottom: 15px;">
                            <h4><i class="fab fa-spotify"></i> ${data.mood} Vibes</h4>
                            <p>Curated playlists matching ${weather} weather</p>
                        </div>
                        <div class="playlist-container">${playlistsHTML}</div>
                    `;
                } else {
                    document.getElementById('spotify').innerHTML = `
                        <p style="text-align: center; color: #64748b; padding: 40px;">
                            <i class="fab fa-spotify" style="font-size: 3rem; margin-bottom: 15px; display: block;"></i>
                            Spotify playlists unavailable<br>
                            <small>Recommended mood: ${data.mood || weather}</small>
                        </p>
                    `;
                }
            } catch (error) {
                document.getElementById('spotify').innerHTML = '<p>Failed to load playlists</p>';
            }
        }

        async function loadSounds(weather) {
            try {
                const response = await fetch(`${API_BASE}/entertainment/sounds?weather=${weather}`);
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('sounds').innerHTML = `
                        <div class="sound-player">
                            <div class="sound-icon"><i class="fas fa-headphones"></i></div>
                            <h3 style="margin-bottom: 10px;">${data.primary_sound.description}</h3>
                            <p style="color: #64748b; margin-bottom: 10px;">${data.mood} ambient sounds ${data.emoji}</p>
                            <div class="sound-controls">
                                <button class="sound-btn" onclick="toggleSound('${data.primary_sound.url}')">
                                    <i class="fas fa-play" id="playIcon"></i>
                                </button>
                                <button class="sound-btn" onclick="stopSound()">
                                    <i class="fas fa-stop"></i>
                                </button>
                            </div>
                            <div class="volume-control">
                                <i class="fas fa-volume-down"></i>
                                <input type="range" class="volume-slider" min="0" max="100" value="70" onchange="setVolume(this.value)">
                                <i class="fas fa-volume-up"></i>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('sounds').innerHTML = '<p>Failed to load sounds</p>';
            }
        }

        function displayHealthTips(data) {
            if (!data.health_tips || data.health_tips.length === 0) {
                document.getElementById('healthTips').innerHTML = '<p>No health tips available</p>';
                return;
            }

            const tipsHTML = data.health_tips.map(tip => `
                <div class="health-tip">
                    <div class="health-tip-icon"><i class="fas fa-heart-pulse"></i></div>
                    <div>${tip}</div>
                </div>
            `).join('');

            document.getElementById('healthTips').innerHTML = `
                <div class="health-tips">${tipsHTML}</div>
            `;
        }

        function displayClothingTips(data) {
            if (!data.clothing_recommendations || data.clothing_recommendations.length === 0) {
                document.getElementById('clothingTips').innerHTML = '<p>No clothing recommendations available</p>';
                return;
            }

            const clothingHTML = data.clothing_recommendations.map(item => `
                <div class="clothing-tag">
                    <i class="fas fa-check-circle"></i>
                    ${item}
                </div>
            `).join('');

            document.getElementById('clothingTips').innerHTML = `
                <div class="clothing-items">${clothingHTML}</div>
            `;
        }

        function displayColorPalette(data) {
            if (!data.color_palette || data.color_palette.length === 0) {
                document.getElementById('colorPalette').innerHTML = '<p>No color palette available</p>';
                return;
            }

            const colorsHTML = data.color_palette.map(color => `
                <div class="color-swatch" style="background-color: ${color};" 
                     onclick="copyToClipboard('${color}')" 
                     title="Click to copy ${color}"></div>
            `).join('');

            document.getElementById('colorPalette').innerHTML = `
                <p style="margin-bottom: 15px; color: #64748b;">Weather-inspired color palette</p>
                <div class="color-palette">${colorsHTML}</div>
                <p style="margin-top: 15px; font-size: 0.85rem; color: #64748b;">
                    <i class="fas fa-info-circle"></i> Click any color to copy
                </p>
            `;
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert(`Color ${text} copied to clipboard!`);
            });
        }

        function toggleSound(url) {
            if (isPlaying) {
                audioPlayer.pause();
                isPlaying = false;
                document.getElementById('playIcon').className = 'fas fa-play';
            } else {
                audioPlayer.src = url;
                audioPlayer.play();
                isPlaying = true;
                document.getElementById('playIcon').className = 'fas fa-pause';
            }
        }

        function stopSound() {
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            isPlaying = false;
            if (document.getElementById('playIcon')) {
                document.getElementById('playIcon').className = 'fas fa-play';
            }
        }

        function setVolume(value) {
            audioPlayer.volume = value / 100;
        }

        async function exploreWeather() {
            try {
                const response = await fetch(`${API_BASE}/weather/explore?count=6&units=${currentUnit}`);
                const data = await response.json();
                
                if (data.success) {
                    const citiesHTML = data.cities.map(city => `
                        <div class="city-card" onclick="loadWeatherByCoords(${city.coordinates.lat}, ${city.coordinates.lon})">
                            <div class="city-name">${city.city}</div>
                            <div class="city-country">${city.country}</div>
                            <div class="city-weather">${city.weather.emoji || getWeatherIcon(city.weather.main)}</div>
                            <div class="city-temp">${Math.round(city.temperature)}¬∞</div>
                            <div class="city-desc">${city.weather.description}</div>
                        </div>
                    `).join('');
                    
                    document.getElementById('explore').innerHTML = `
                        <div class="explore-grid">${citiesHTML}</div>
                    `;
                }
            } catch (error) {
                document.getElementById('explore').innerHTML = '<p>Failed to explore weather</p>';
            }
        }

        async function compareCities() {
            const input = document.getElementById('compareInput').value;
            if (!input) return;

            const cities = input.split(',').map(c => c.trim()).filter(c => c);
            
            try {
                const response = await fetch(`${API_BASE}/weather/compare?cities=${cities.join(',')}&units=${currentUnit}`);
                const data = await response.json();
                
                if (data.success && data.comparison.length > 0) {
                    const compareHTML = data.comparison.map(city => `
                        <div class="city-card">
                            <div class="city-name">${city.city}</div>
                            <div class="city-country">${city.country}</div>
                            <div class="city-weather">${city.weather.emoji || getWeatherIcon(city.weather.main)}</div>
                            <div class="city-temp">${Math.round(city.temperature)}¬∞</div>
                            <div class="city-desc">${city.weather.description}</div>
                            <div style="margin-top: 10px;">
                                <span class="badge badge-info">${city.humidity}% humidity</span>
                                <span class="badge badge-primary">${city.wind_speed} m/s wind</span>
                            </div>
                        </div>
                    `).join('');
                    
                    document.getElementById('compareResults').innerHTML = `
                        <div class="explore-grid">${compareHTML}</div>
                    `;
                } else {
                    document.getElementById('compareResults').innerHTML = '<p>No results found</p>';
                }
            } catch (error) {
                document.getElementById('compareResults').innerHTML = '<p>Failed to compare cities</p>';
            }
        }

        function loadWeatherByCoords(lat, lon) {
            loadWeather(lat, lon);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showError(message) {
            document.getElementById('errorContainer').innerHTML = `
                <div class="error">
                    <strong><i class="fas fa-circle-exclamation"></i> Error:</strong> ${message}
                </div>
            `;
            setTimeout(() => {
                document.getElementById('errorContainer').innerHTML = '';
            }, 5000);
        }

        document.getElementById('cityInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') searchWeather();
        });

        document.getElementById('compareInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') compareCities();
        });

        createParticles();
        autoDetectLocation();
        setVolume(70);
    </script>
</body>
</html>